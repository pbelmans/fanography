{# overview table #}
{% macro table(fanos, rho) %}
<table class="overview table table-hover table-sm">
  <thead>
    <tr>
      <th scope="col" class="text-center">ID</th>
      <th scope="col" class="text-center">$-\mathrm{K}_X^3$</th>
      <th scope="col" class="text-center">$\mathrm{h}^{1,2}$</th>

      {% if rho in [1, 2, 3] %}
        <th scope="col" class="text-center">index</th>
      {% endif %}
      <th scope="col">description</th>

      {% if rho != 10 %}
        <th scope="col" class="text-center"><span class="d-none d-lg-block">blowups</span></th>
      {% endif %}

      {% if rho != 1 %}
        <th scope="col" class="text-center"><span class="d-none d-lg-block">blowdowns</span></th>
      {% endif %}

      <th scope="col" class="text-center"><span class="d-none d-lg-block">rational</span></th>
      <th scope="col" class="text-center"><span class="d-none d-lg-block">unirational</span></th>
    </tr>
  </thead>

  <tbody>
    {% for ID in fanos.keys() | sort %}
      {% set fano = fanos[ID] %}

      <tr>
        <td class="align-middle row-identifier"><a class="identifier text-nowrap" href="/{{ fano["rho"] }}-{{ fano["ID"] }}">{{ fano["rho"] }}&ndash;{{ fano["ID"] }}</a></td>

        <td class="align-middle volume text-center">{{ fano["KX3"] }}</td>

        <td class="align-middle h12 text-center">{{ fano["h12"] }}</td>

        {% if rho in [1, 2, 3] %}
          <td class="align-middle index text-center" scope="col">{{ fano["index"] }}</td>
        {% endif %}

        <td class="align-middle">{{ fano["description"] | safe }}</td>

        {% if rho != 10 %}
          <td class="align-middle text-center">
            {% if fano["blowup"] %}yes{% endif %}
          </td>
        {% endif %}

        {% if rho != 1 %}
          <td class="align-middle text-center">
          {% for blowdown in fano["blowdown"] %}
            <a href="/{{ blowdown.identifier() }}" class="identifier text-nowrap">{{ blowdown.identifier() | replace("-", "&ndash;") | safe }}</a>
          {% endfor %}
          </td>
        {% endif %}

        <td class="align-middle text-center">{{ fano["rationality"] }}</td>
        <td class="align-middle text-center">{{ fano["unirationality"] }}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% endmacro %}

{# generic component layout #}
{% macro component(header, content) %}
<div class="card">
  <div class="card-header">{{- header }}</div>

  <div class="card-body">
    {{ content }}
  </div>
</div>
{% endmacro %}


{# basic information on X #}
{% macro basic(fano, previous, next) %}
<h5 class="card-title">Fano variety <span class="identifier">{{ fano['rho'] }}&ndash;{{ fano['ID'] }}</span></h5>
<p>{{ fano["description"] | safe }}

<dl class="row">
  <dt class="col-6 text-right">rank
  <dd class="col-6">{{ fano["rho"] }}
  {% if fano["rho"] in [1, 2, 3, 4, 5] %}(<a href="/{{ fano["rho"] }}">others</a>){% endif %}

  <dt class="col-6 text-right">$-\mathrm{K}_X^3$
  <dd class="col-6">{{ fano["KX3"] }}

  <dt class="col-6 text-right">$\mathrm{h}^{1,2}(X)$
  <dd class="col-6">{{ fano["h12"] }}
</dl>

<p class="clearfix">
{% if previous %}
  <a class="previous float-left identifier" href="/{{ fano["rho"] }}-{{ fano["ID"] - 1}}">{{ fano["rho"] }}&ndash;{{ fano["ID"] - 1 }}</a>
{% endif %}

{% if next %}
  <a class="next float-right identifier" href="/{{ fano["rho"] }}-{{ fano["ID"] + 1}}">{{ fano["rho"] }}&ndash;{{ fano["ID"] + 1 }}</a>
{% endif %}
</p>
{% endmacro %}


{# information about |-K_X| #}
{% macro anticanonical(fano) %}
<dl class="row">
  <dt class="col-6 text-right">index</dt>
  <dd class="col-6">{{ fano["index"] }}</dd>

  <dt class="col-6 text-right">$\dim\mathrm{H}^0(X,\omega_X^\vee)$</dt>
  <dd class="col-6">{{ fano["KX3"] // 2 + 3 }}</dd>

  {# page 216 of Iskovskikh--Prokhorov, remark (ii) #}
  <dt class="col-6 text-right">basepoint free</dt>
  {% if (fano["rho"], fano["ID"]) not in [(2, 1), (3, 8)] %}
    <dd class="col-6 text-nowrap">yes</dd>
  {% else %}
    <dd class="col-6 text-nowrap">no</dd>
  {% endif %}

  {# page 216 of Iskovskikh--Prokhorov, remark (iii) #}
  <dt class="col-6 text-right">hyperelliptic</dt>
  {% if (fano["rho"], fano["ID"]) not in [(2, 2), (2, 3), (10, 1)] %}
    <dd class="col-6 text-nowrap">no
  {% else %}
    <dd class="col-6 text-nowrap">yes
  {% endif %}

  {# page 216 of Iskovskikh--Prokhorov, remark (iv) #}
  <dt class="col-6 text-right">trigonal</dt>
  {% if (fano["rho"], fano["ID"]) not in [(2, 4), (2, 5), (8, 1)] %}
    <dd class="col-6 text-nowrap">no
  {% else %}
    <dd class="col-6 text-nowrap">yes
  {% endif %}
</dl>
{% endmacro %}


{# Hodge diamond #}
{% macro diamond(fano) %}
<div class="diamond">
  <span>1</span><br style="clear: both">

  <span>0</span>
  <span>0</span><br style="clear: both">

  <span>0</span>
  <span>{{ fano["rho"] }}</span>
  <span>0</span><br style="clear: both">

  <span>0</span>
  <span>{{ fano["h12"] }}</span>
  <span>{{ fano["h12"] }}</span>
  <span>0</span><br style="clear: both">

  <span>0</span>
  <span>{{ fano["rho"] }}</span>
  <span>0</span><br style="clear: both">

  <span>0</span>
  <span>0</span><br style="clear: both">

  <span>1</span><br style="clear: both">
</div>
{% endmacro %}


{# information about blowups and blowdowns #}
{% macro birational(fano) %}
{% if fano["is_rational"] %}
  <p>This variety is rational{% if fano["rationality"] == "generic" %}, at least generically{% endif %}.
{% elif fano["is_unirational"] %}
  <p>This variety is not rational but unirational{% if fano["unirationality"] == "some" %}, at least some are{% endif %}.
{% else %}
  <p>This variety is not unirational.
{% endif %}

  <hr>

{% if fano["is_primitive"] %}
  <p>This variety is primitive.<p>
{% else %}
  <p>This variety is the blowup of
  <ul>
    {% for blowdown in fano["blowdown"] %}
      <li><a href="/{{ blowdown.identifier() }}" class="identifier">{{ blowdown.identifier() | replace("-", "&ndash;") | safe }}</a>, in a curve of genus {{ fano["h12"] - blowdown["h12"] }}
    {% endfor %}
  </ul>
{% endif %}

{% if fano["blowup"] %}
  <p>This variety can be blown up (in a curve) to
  <ul>
    {% for blowup in fano["blowup"] %}
      <li><a href="/{{ blowup.identifier() }}" class="identifier">{{ blowup.identifier() | replace("-", "&ndash;") | safe }}</a>, in a curve of genus {{ blowup["h12"] - fano["h12"] }}
    {% endfor %}
  </ul>
{% endif %}
{% endmacro %}


{% macro deformations(fano) %}
<dl class="row">
  <dt class="col-6 text-right">number of moduli</dt>
  {# TODO remove this eventually #}
  {% if fano["moduli"] == -1 %}
    <dd class="col-6"><p class="alert alert-warning">Currently there is no correct value available.</p>
  {% else %}
    <dd class="col-6">{{ fano["moduli"] }}</dd>
  {% endif %}
</dl>
{% endmacro %}
